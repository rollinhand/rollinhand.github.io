<!-- HTML5 HEADER WITH NAVIGATION -->
<!DOCTYPE html>
<html lang="de">
<head>
  <!-- HTML metadata and includes -->
  <!-- Header information like meta information and script resources -->
  <meta http-equiv="content-type" content="text/html; charset=UTF-8" />
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, maximum-scale=1">

  <link rel="icon" href="../../../../../images/favicon.png" type="image/png">
  <link rel="shortcut icon" href="../../../../../images/favicon.png" type="image/png">

  <!-- Stylesheets -->
  <link href="../../../../../css/styles.css" rel="stylesheet" type="text/css">
  <link href="../../../../../css/github.css" rel="stylesheet" type="text/css">
  <!-- Bootstrap icons-->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.5.0/font/bootstrap-icons.css" rel="stylesheet" />

  <!-- Feeds -->
  <link rel="alternate" type="application/atom+xml" title="Atom" href="../../../../../feed.xml" />

  <!-- Load Highlight.js -->
  <script src="../../../../../js/highlight.pack.js"></script>
  <title>JRE mit Eclipse RCP-Anwendung bündeln</title>
</head>
<body class="d-flex flex-column h-100">
  <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
    <div class="container px-5">
      <a class="navbar-brand" href="../../../../../index.html"><img class="logo" src="../../../../../images/kivio-white.png" alt="Logo"></a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button>
      <div class="collapse navbar-collapse" id="navbarSupportedContent">
        <ul class="navbar-nav mb-2 mx-1 mb-lg-0">
            <li class="nav-item mx-1 ">
              <a class="nav-link " href="../../../../../category/allgemein/index.html">Allgemein</a>
            </li>
            <li class="nav-item mx-1 ">
              <a class="nav-link " href="../../../../../category/devops/index.html">DevOps</a>
            </li>
            <li class="nav-item mx-1 ">
              <a class="nav-link " href="../../../../../category/entwicklung/index.html">Entwicklung</a>
            </li>
            <li class="nav-item mx-1 ">
              <a class="nav-link " href="../../../../../category/technologie/index.html">Technologie</a>
            </li>
        </ul>
        <ul class="navbar-nav ms-auto mb-2 mb-lg-0">
<a href="../../../../../about/index.html">
    <img class="avatar avatar-small" alt="rollinhand" width="40" height="40" data-proofer-ignore="true"
         src="https://avatars2.githubusercontent.com/rollinhand?v=3&s=40"
         srcset="https://avatars2.githubusercontent.com/rollinhand?v=3&s=40 1x, https://avatars2.githubusercontent.com/rollinhand?v=3&s=80 2x, https://avatars2.githubusercontent.com/rollinhand?v=3&s=120 3x, https://avatars2.githubusercontent.com/rollinhand?v=3&s=160 4x"/></a>        </ul>
      </div>
    </div>
  </nav>
<main class="flex-shrink-0">
	<!-- Page Content-->
	<section class="py-5">
		<div class="container px-5 my-5">
			<div class="row gx-5">
				<div class="col-lg-3">
					<div class="d-flex align-items-center mt-lg-5 mb-4">
<a href="../../../../../about/index.html">
    <img class="avatar avatar-small" alt="rollinhand" width="40" height="40" data-proofer-ignore="true"
         src="https://avatars2.githubusercontent.com/rollinhand?v=3&s=40"
         srcset="https://avatars2.githubusercontent.com/rollinhand?v=3&s=40 1x, https://avatars2.githubusercontent.com/rollinhand?v=3&s=80 2x, https://avatars2.githubusercontent.com/rollinhand?v=3&s=120 3x, https://avatars2.githubusercontent.com/rollinhand?v=3&s=160 4x"/></a>						<div class="small ms-3">
							<div class="fw-bold">Björn Berg</div>
						</div>
					</div>
					<!-- Hinweis auf fremden Blog-Artikel -->
				</div>
				<div class="col-lg-9">
					<!-- Post content-->
					<article>
						<!-- Post header-->
						<header class="mb-4">
							<!-- Post title-->
							<h1 class="fw-bolder mb-1">JRE mit Eclipse RCP-Anwendung bündeln</h1>
							<!-- Post meta content-->
							<div class="text-muted fst-italic mb-2">09.07.2020</div>
							<!-- Post categories-->
								<a class="badge bg-primary text-decoration-none link-light" href="/category/entwicklung">Entwicklung</a>
							<!-- Post tags -->
									<span class="badge bg-secondary text-decoration-none link-light">Eclipse RCP</span>
									<span class="badge bg-secondary text-decoration-none link-light">Tycho</span>
						</header>
						<!-- Post content-->
						<section class="mb-5">
							<p>Die Auslieferung der eigenen Eclipse RCP-Anwendung ist mit <a href="../../../2020/06/28/eclipse-rcp-tipps-und-tricks.html">Tycho fast ein Kinderspiel</a>. Ebenso einfach lässt sich die Anwendung auch mit ihrer eigenen Java Laufzeitumgebung (JRE) bündeln. In diesem Beitrag zeige ich wie das funktioniert und stelle alternative Wege vor.</p>
<!--more-->
<p>Seit einiger Zeit ist der Bau von Eclipse-Anwendungen mit Tycho der präferierte Weg, um eine auslieferbare Anwendung zu erstellen. Während in der guten, alten Plugin Development Environment (PDE) beim Produkt-Export eine Execution Environment angegeben werden kann, ist dies bei Tycho nicht so offensichtlich.</p>
<p><img src="rcp01-jre-product-launching.png" style="width:70%;margin:auto"/></p>
<p>Tycho nutzt das Konzept der <a href="https://help.eclipse.org/2019-12/index.jsp?topic=%2Forg.eclipse.pde.doc.user%2Ftasks%2Fpde_rootfiles.htm">Root files</a> zur Einbindung von statischen Dateien und somit auch der JRE.</p>
<h2>Nutzung von Root files</h2>
<p>Die <a href="https://help.eclipse.org/2019-12/index.jsp?topic=%2Forg.eclipse.pde.doc.user%2Ftasks%2Fpde_rootfiles.htm">Root files</a> sind ein Relikt aus dem PDE-Build. Root files finden immer dann Verwendung in einem Build von Eclipse-Anwendungen, wenn statische Dateien oder Ordner in eine Installation eingebunden werden müssen, die sich nicht über ein Feature oder Plugin abbilden lassen.</p>
<p>Typische Beispiele sind die <em>config.ini</em> oder Lizenzdateien. Ebenso Eclipse-Installationen mit einer paketierten JRE. Über die Datei <em>build.properties</em> wird das Hinzufügen statischer Elemente zur Installation gesteuert. Die Konfiguration folgt einem Baum-artigen Muster bzw. ist vergleichbar mit den Property-Strukturen in Java. Die Parameter beginnen immer mit <em>root</em>.</p>
<p>Details zu den <a href="https://help.eclipse.org/2019-12/index.jsp?topic=%2Forg.eclipse.pde.doc.user%2Ftasks%2Fpde_rootfiles.htm">Root files</a> können der offiziellen <a href="https://help.eclipse.org/2019-12/index.jsp?topic=%2Forg.eclipse.pde.doc.user%2Ftasks%2Fpde_rootfiles.htm">Eclipse Hilfe</a> entnommen werden. Die Möglichkeiten sind einen eigenen Blogbeitrag wert.</p>
<h2>Statisches Bundling über Rootfiles</h2>
<p>Zum <a href="http://eclipseo.blogspot.com/2014/11/bundle-jre-along-with-your-product.html">Bündeln der JRE mit dem eigenen Produkt</a>, sollte zunächst ein eigenes Feature erstellt werden, dass ausschließlich für die Verwaltung der auszuliefernden Laufzeitumgebungen für die unterstützten Plattformen genutzt wird.</p>
<p>Innerhalb des Features werden für die verschiedenen Umgebungen Ordner angelegt in die die JRE kopiert wird (siehe Screenshot).</p>
<p><img src="rcp01-jre-folder-structure.png" style="width:40%;margin:auto"/></p>
<p>Dabei spielt die Bezeichnung des Root-Ordners keine Rolle. Wichtig ist der Ordner mit dem Namen <em>jre</em> unterhalb. Beim Produktexport wird dieser in den Root-Ordner des Produkts exportiert. Die Eclipse-Launcher suchen parallel zu ihrem Installationsort nach einem Verzeichnis mit dem Namen <em>jre</em> und nutzen die darin befindliche JRE zum Start der Eclipse-Anwendung.</p>
<p>Im Screenshot sind die Laufzeitumgebungen für die 64-Bit Versionen von Windows, Linux und Mac OS zu sehen. Die Magie beim Bauen und die Zuordnung zur exportierten Umgebung erfolgt über die Datei <em>build.properties</em>, die im Textmodus bearbeitet werden muss. Die grafische Ansicht in der Eclipse IDE unterstützt das Editieren von Root files derzeit nicht. In die Datei fügen wir die folgenden Zeilen ein:</p>
<pre><code>root.win32.win32.x86_64 = win64
root.macosx.cocoa.x86_64 = osx64
root.linux.gtk.x86_64 = lnx64
</code></pre>
<p>Final sollte die <em>build.properties</em> wie folgt aussehen:</p>
<p><img src="rcp01-jre-build-properties.png" style="width:40%;margin:auto"/></p>
<p>Die Struktur für die Definition der Root files folgt damit den Parametern zur Definition einer Target Environment in Tycho.</p>
<p>Anschließend muss das Feature noch in der Produkt-Definition eingefügt werden, sodass es beim Materialisieren des Produkts berücksichtigt wird.</p>
<p><img src="rcp01-jre-product-definition.png" width="894" width="366" style="width:70%;margin:auto"/></p>
<p>Beim Bau der Anwendung mittels Maven/Tycho werden die Angaben für die Zielumgebung auf Basis der Architektur und des Betriebssystems interpretiert und im erstellten Produktverzeichnis jeweils ein Verzeichnis  mit dem Namen <em>jre</em> passend zur exportierten Plattform erstellt.</p>
<p><img src="rcp01-jre-final-folder.png" style="width:40%;margin:auto" /></p>
<h2>Mehr Dynamik mit dem Maven-Universum</h2>
<p>Die vorangegangenen Ausführungen haben einen Schwachpunkt=Wenn das Projekt versioniert ist (was es in einem professionellen Kontext hoffentlich ist), so werden Binärdateien zusammen mit dem Source-Code eingecheckt. Das ist nicht schön und sehr statisch.</p>
<p>Besser wäre es, die aktuelle JRE für die jeweiligen Umgebungen während des Builds zu laden und dynamisch einzubinden. Damit wird vergleichbar den Maven Dependencies ein Mechanismus geschaffen, der bei Bedarf Abhängigkeiten aus einer zentralen Quelle lädt. Damit dies nicht bei jedem Build von vorne passiert, sollte das dafür zuständige Plugin wissen, welche Dateien bereits geladen worden sind.</p>
<p>Genau für diesen Zweck existiert das <a href="https://github.com/maven-download-plugin/maven-download-plugin">Download Plugin</a> für Maven. Es besitzt das Goal <em>wget</em> zum Laden von Dateien aus HTTP-Quellen ohne die Nutzung von zusätzlichen ANt Skripten. Weiterhin unterstützt es Caching und kann bei der Angabe eines MD5-Hashes die Signatur eines heruntergeladenen Artefakts prüfen.</p>
<p>Ein weiteres Goodie=Mit der Option <em>unpack</em> können komprimierte Artefakte direkt im Zielverzeichnis entpackt werden. Es ist nicht notwendig, das Maven Assembly-Plugin separat zu starten.</p>
<p>In unserem vorangegangenem Beispiel wird nun die POM überarbeitet. Für alle unterstützten Zielarchitekturen laden wir das Adopt OpenJDK und entpacken es in das Zielverzeichnis.</p>
<p>Anschließend wird das Verzeichnis noch in <em>jre</em> mithilfe des Antrun-Plugins umbenannt.</p>
<p>{% gist 2db9c15eb483fb9ab5a7f8765ea29599 %}</p>
<p>Das vollständige Beispiel inkl. kompilierfähiger und ausführbarer Anwendung findet sich auf <a href="https://github.com/rollinhand/eclipse-rcp-examples">Github</a> in den RCP Examples als rcp01 klassifiziert.</p>

						</section>
					</article>
					<section>
						<div class="card bg-light">
							<div class="card-body">
								<h5><i class="fa fa-comment"></i> Kommentar</h5>

								<div class="mt-3">
									<p>Du möchtest diskutieren oder einen Kommentar zu dem Beitrag hinterlassen?</p>
									<small class="text-muted">Dieser Blog hat keine öffentliche Kommentarfunktion, aber ich freue mich jederzeit über eine
										<a href="mailto:rollin.hand@gmx.de">Mail</a> mit kritischen Anmerkungen, Feedback oder auch einfach nur
										Lob an meine Mail-Adresse <a href="mailto:rollin.hand@gmx.de">rollin.hand[@]gmx.de</a>.</small>
								</div>
							</div>
						</div>
					</section>
				</div>
			</div>
		</div>
	</section>
</main>
<!-- HTML5 FOOTER -->
<footer class="bg-dark py-4 mt-auto">
    <div class="container px-5">
        <div class="row align-items-center justify-content-between flex-column flex-sm-row">
            <div class="col-auto">
                <div class="small m-0 text-white">Copyright &copy; 2017 - 2025 by Björn Berg</div>
            </div>
            <div class="col-auto">
                <a class="link-light small" href="../../../../../blog/meecrowave.html">Apache Meecrowave</a>
                <span class="text-white mx-1">&middot;</span>
                <a class="link-light small" href="../../../../../privacy-policy/index.html">Privacy</a>
                <span class="text-white mx-1">&middot;</span>
                <a class="link-light small" href="../../../../../about/index.html">Imprint</a>
                <span class="text-white mx-1">&middot;</span>
                <a class="link-light small" href="mailto:rollin.hand@gmx.de">Contact</a>
            </div>
            <div class="col-auto">
                <a class="link-light text-decoration-none mx-1 small" href="https://www.xing.com/profile/Bjoern_Berg2" target="_blank" rel="me">
                    <span class="button xing" aria-details="Xing"><i class="fab fa-xing"></i></span>
                </a>
                <a class="link-light text-decoration-none mx-1 small" href="https://www.linkedin.com/in/bjoernberg82" target="_blank" rel="me">
                    <span class="button linkedin" aria-details="LinkedIn"><i class="fab fa-linkedin"></i></span>
                </a>
                <a class="link-light text-decoration-none mx-1 small" href="../../../../../feed.xml">
                    <span class="button atom" aria-details="Atom/RSS"><i class="fas fa-rss subscribe"></i></span>
                </a>
            </div>
        </div>
    </div>
</footer>
<!-- Bootstrap core JS-->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
<!-- Core theme JS-->
<script src="js/scripts.js"></script>
<script>hljs.initHighlightingOnLoad();</script>
</body>
</html>